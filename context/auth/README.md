# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [auth-quick-guide.md](./auth-quick-guide.md) - **–ù–∞—á–Ω–∏ –æ—Ç—Å—é–¥–∞!** –ë—ã—Å—Ç—Ä—ã–π –≥–∞–π–¥ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
2. [auth-system.md](./auth-system.md) - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
3. [client-vs-server-auth.md](./client-vs-server-auth.md) - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
4. [use-auth-guard.md](../hooks/use-auth-guard.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ö—É–∫–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã —Ä–æ—É—Ç–æ–≤

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É

‚úÖ **–£–¥–∞–ª–µ–Ω–æ:**

- –°–µ—Ä–≤–µ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ `root.tsx` loader
- –ü—Ä–æ–≤–µ—Ä–∫–∞ cookies –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `credentials: "include"` –∏–∑ API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ:**

- –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Ö—É–∫ `useAuthGuard`
- –¢–æ–∫–µ–Ω –≤ localStorage + Redux
- Authorization header –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –°–æ–∑–¥–∞–Ω–æ

1. **Auth Slice** (`app/entities/session/model/auth.slice.ts`)
   - Redux slice –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–º
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å localStorage
   - SSR-–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞

2. **Auth Guard Hook** (`app/shared/lib/hooks/use-auth-guard.ts`)
   - –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—É—Ç–∏ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞

3. **–û–±–Ω–æ–≤–ª–µ–Ω API** (`app/shared/api/index.ts`)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –§–æ—Ä–º–∞—Ç: `Authorization: Bearer {token}`
   - –£–±—Ä–∞–Ω `credentials: "include"`

4. **–û–±–Ω–æ–≤–ª–µ–Ω—ã endpoints** (`app/entities/session/api/session.api.ts`)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø–æ—Å–ª–µ login/register
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `onQueryStarted` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

5. **–û–±–Ω–æ–≤–ª–µ–Ω store** (`app/core/store/store.ts`)
   - –ü–æ–¥–∫–ª—é—á–µ–Ω auth reducer

6. **–û–±–Ω–æ–≤–ª–µ–Ω Layout** (`app/core/layout/appLayout.tsx`)
   - –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `useAuthGuard()` –¥–ª—è –∑–∞—â–∏—Ç—ã —Ä–æ—É—Ç–æ–≤

7. **–£–ª—É—á—à–µ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã** (`app/pages/login`, `app/pages/register`)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.unwrap()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–º–∏—Å–æ–≤
   - –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

8. **–°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** (`app/shared/ui/logout-button`)
   - –ì–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—ã—Ö–æ–¥–∞
   - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ [logout-button.md](../ui-components/logout-button.md)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–≥–∏–Ω

```tsx
const [login] = useLoginMutation();
await login({ username: "user@example.com", password: "password" }).unwrap();
// ‚úÖ –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### –í—ã—Ö–æ–¥

```tsx
const dispatch = useDispatch();
dispatch(logout());
// ‚úÖ –¢–æ–∫–µ–Ω —É–¥–∞–ª–µ–Ω –∏–∑ Redux –∏ localStorage
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```tsx
const { isAuthenticated } = useSelector((state: RootState) => state.auth);
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
app/
‚îú‚îÄ‚îÄ entities/session/
‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.slice.ts           ‚Üê –ù–æ–≤—ã–π —Ñ–∞–π–ª (Redux slice)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ session.api.ts          ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω onQueryStarted)
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                    ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (—ç–∫—Å–ø–æ—Ä—Ç—ã)
‚îÇ
‚îú‚îÄ‚îÄ core/store/
‚îÇ   ‚îî‚îÄ‚îÄ store.ts                    ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–ø–æ–¥–∫–ª—é—á–µ–Ω auth reducer)
‚îÇ
‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts                ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ headers)
‚îÇ   ‚îî‚îÄ‚îÄ ui/
‚îÇ       ‚îî‚îÄ‚îÄ logout-button/          ‚Üê –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ           ‚îú‚îÄ‚îÄ logout-button.tsx
‚îÇ           ‚îî‚îÄ‚îÄ index.ts
‚îÇ
‚îî‚îÄ‚îÄ pages/
    ‚îú‚îÄ‚îÄ login/ui/login-page.tsx     ‚Üê –£–ª—É—á—à–µ–Ω (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)
    ‚îî‚îÄ‚îÄ register/ui/register-page.tsx ‚Üê –£–ª—É—á—à–µ–Ω (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)
```

## üîÑ –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å
   ‚Üì
2. useLoginMutation –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å
   ‚Üì
3. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç { access_token, token_type }
   ‚Üì
4. onQueryStarted ‚Üí dispatch(setToken(access_token))
   ‚Üì
5. Auth Slice —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω –≤:
   - Redux store (state.auth.token)
   - localStorage (access_token)
   ‚Üì
6. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ API –∑–∞–ø—Ä–æ—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç:
   Authorization: Bearer {token}
```

## üîë –ö–ª—é—á–µ–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã

```tsx
// –•—É–∫–∏
import {
  useLoginMutation,
  useRegisterMutation,
  useUserInfoQuery,
} from "@/entities/session";

// Actions
import { setToken, logout } from "@/entities/session";

// UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
import { LogoutButton } from "@/shared/ui";

// –¢–∏–ø—ã
import type { RootState } from "@/core/store/store";
```

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ localStorage –ø–æ—Å–ª–µ login/register
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏–∑ localStorage –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ logout
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [auth-quick-guide.md](./auth-quick-guide.md) - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [auth-system.md](./auth-system.md) - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [logout-button.md](../ui-components/logout-button.md) - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç LogoutButton
- [session.api.ts](../api/session-api.md) - API endpoints (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üêõ Troubleshooting

**–¢–æ–∫–µ–Ω –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å—ã?**
‚Üí –ü—Ä–æ–≤–µ—Ä—å: `console.log(store.getState().auth.token)`

**–¢–æ–∫–µ–Ω —Ç–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏?**
‚Üí –ü—Ä–æ–≤–µ—Ä—å localStorage: `localStorage.getItem("access_token")`

**401 Unauthorized –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞?**
‚Üí –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `Bearer {token}`

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [FSD Architecture](../fsd-structure.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [RTK Query](https://redux-toolkit.js.org/rtk-query/overview) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è RTK Query
- [Redux Toolkit](https://redux-toolkit.js.org/) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Redux Toolkit

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–º. –¥–µ—Ç–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ [auth-system.md](./auth-system.md)
